import{r as i,m as g,j as e,S as L}from"./app-CrM3bAr7.js";import{I as B}from"./input-error-B-ImtbXT.js";import{B as o}from"./button-DSYtEUz-.js";import{C as F}from"./confirm-delete-dialog-6UrjvZCz.js";import{D as V,a as R,b as U,c as X,d as q}from"./dialog-13Vh7iYP.js";import{I as j}from"./input-BwgTVrff.js";import{L as G}from"./label-Dif50TA4.js";import{c as J}from"./createLucideIcon-BQ0uF5zu.js";import{X as K}from"./x-DprXbeJV.js";import{P as Q}from"./pencil-fd9eBnUr.js";import{T as W}from"./trash-2-BGsS4Tma.js";import{S as Y}from"./send-WmHc0PdS.js";import"./utils-jAU0Cazi.js";import"./index-C7o-dAq6.js";import"./index-DZZQifJx.js";import"./alert-dialog-DBPQtoSw.js";import"./index-BYkqkD9G.js";import"./index-DCk08MMz.js";import"./index-C07_Bs9F.js";import"./tslib.es6-CMwweBXX.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],$=J("Save",Z);function we({subsystem:t,isOpen:v,onOpenChange:N,can:l}){const[w,r]=i.useState([]),[D,c]=i.useState(null),[S,d]=i.useState(!1),[m,p]=i.useState(null),{data:P,setData:h,post:C,processing:u,errors:E,reset:I}=g({name:"",subsystem_id:null}),{data:x,setData:f,post:k,processing:y,errors:ee,reset:T}=g({name:"",_method:"PUT"});i.useEffect(()=>{t&&(r(t.inspection_points),h("subsystem_id",t.id))},[t]);const b=s=>{s.preventDefault(),t&&C(route("inspection-points.add",t.id),{preserveScroll:!0,onSuccess:a=>{const n=a.props.flash;n&&n.newPoint&&r(H=>[...H,n.newPoint]),I("name")}})},A=s=>{c(s.id),f("name",s.name)},M=()=>{c(null),T()},_=s=>{k(route("inspection-points.update",s),{preserveScroll:!0,onSuccess:()=>{r(a=>a.map(n=>n.id===s?{...n,name:x.name}:n)),c(null)}})},z=s=>{p(s),d(!0)},O=()=>{m&&L.delete(route("inspection-points.destroy",m),{preserveScroll:!0,onSuccess:()=>{r(s=>s.filter(a=>a.id!==m)),d(!1),p(null)}})};return e.jsxs(e.Fragment,{children:[e.jsx(V,{open:v,onOpenChange:N,children:e.jsxs(R,{className:"bg-popover sm:max-w-2xl",children:[e.jsxs(U,{children:[e.jsx(X,{children:"Manage Inspection Points"}),e.jsxs(q,{children:['Add, edit, or delete inspection points for the "',t==null?void 0:t.name,'" subsystem.']})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsx("div",{className:"max-h-64 space-y-2 overflow-y-auto pr-2",children:w.map(s=>e.jsx("div",{className:"flex items-center gap-2 rounded-md bg-gray-100 border p-2",children:D===s.id?e.jsxs("div",{className:"flex flex-1 items-center gap-2",children:[e.jsx(j,{value:x.name,onChange:a=>f("name",a.target.value),className:"h-8"}),e.jsx(o,{size:"icon",className:"h-8 w-8",onClick:()=>_(s.id),disabled:y,children:e.jsx($,{className:"h-4 w-4"})}),e.jsx(o,{variant:"ghost",size:"icon",className:"text-destructive h-8 w-8 hover:bg-destructive hover:text-destructive-foreground",onClick:M,children:e.jsx(K,{className:"h-4 w-4"})})]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"flex-1",children:s.name}),l.edit&&e.jsx(o,{variant:"outline",size:"icon",className:"h-8 w-8",onClick:()=>A(s),children:e.jsx(Q,{className:"h-4 w-4"})}),l.delete&&e.jsx(o,{variant:"destructive",size:"icon",className:"h-8 w-8",onClick:()=>z(s.id),children:e.jsx(W,{className:"h-4 w-4"})})]})},s.id))}),l.create&&e.jsxs("div",{className:"border-t pt-4",children:[e.jsx(G,{children:"Add New Inspection Point"}),e.jsxs("form",{onSubmit:b,className:"mt-2 flex items-center gap-2",autoComplete:"off",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(j,{className:"drop-shadow-md shadow-md bg-gray-100 ring-1 ring-ring",value:P.name,onChange:s=>h("name",s.target.value),placeholder:"e.g., Check oil level"}),e.jsx(B,{message:E.name,className:"mt-1"})]}),e.jsxs(o,{className:"drop-shadow-md shadow-md",type:"submit",disabled:u,children:[e.jsx(Y,{}),u?"Adding...":"Add Point"]})]})]})]})]})}),e.jsx(F,{isOpen:S,onOpenChange:d,onConfirm:O,title:"Delete Inspection Point",description:"This action cannot be undone. Are you sure you want to permanently delete this inspection point?"})]})}export{we as ManageInspectionPointsModal};
