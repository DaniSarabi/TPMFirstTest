import{r as s,m as F,S as C,j as t,L as P}from"./app-CrM3bAr7.js";import{u as B,D as G,g as V}from"./data-table-DUdic_wO.js";import{D as q}from"./data-table-view-options-4_U_3RXz.js";import{L as z}from"./list-toolbar-E0ROXguB.js";import{P as H}from"./pagination-Dz5UDBcr.js";import{B as J}from"./button-DSYtEUz-.js";import{A as K}from"./app-layout-CK9_8PlX.js";import{G as Q}from"./general-settings-layout-CkIbxbx9.js";import{u}from"./useCan-CJh7wlIU.js";import{BehaviorsInfoModal as U}from"./BehaviorsInfoModal-DoMGKoj-.js";import{getColumns as W}from"./Columns-BOWitUye.js";import{ReassignAndDeleteStatusModal as X}from"./ReassindAndDeleteTicketsStatusModal-DKwwoKhS.js";import{TicketStatusFormModal as Y}from"./TicketStatusFormModal-5LxC93Ls.js";import{C as Z}from"./circle-plus-C35qyZhc.js";import"./utils-jAU0Cazi.js";import"./dropdown-menu-D615tSEK.js";import"./index-ChLr_mRA.js";import"./index-CipIuUZM.js";import"./index-GEmL2IxC.js";import"./index-DCk08MMz.js";import"./index-Dyr2mIP4.js";import"./index-Cxnn9A7l.js";import"./index-6v8HNz3P.js";import"./floating-ui.react-dom-D6wYppxE.js";import"./index-fR5QWmBt.js";import"./index-rQBWhrbd.js";import"./index-Dd5Vhwor.js";import"./index-C07_Bs9F.js";import"./tslib.es6-CMwweBXX.js";import"./check-BKXQxHa7.js";import"./createLucideIcon-BQ0uF5zu.js";import"./input-BwgTVrff.js";import"./select-ZNRTKmmh.js";import"./index-D9YkVoQb.js";import"./index-CFGBrPdz.js";import"./chevron-down-BZjTBYLj.js";import"./chevron-left-D6TzJdSq.js";import"./chevron-right-B5DMNuK2.js";import"./index-C7o-dAq6.js";import"./index-DZZQifJx.js";import"./index-BYkqkD9G.js";import"./x-DprXbeJV.js";import"./tooltip-DWc-CuE-.js";import"./user-avatar-CalEyW6r.js";import"./chevrons-up-down-CqP_Vf3P.js";import"./shield-check-0vfauCFM.js";import"./badge-IgYfdO9V.js";import"./separator-C07NZpcB.js";import"./heading-BlBufu9I.js";import"./mail-59cOGpao.js";import"./dialog-13Vh7iYP.js";import"./data-table-column-header-B8b-xJ6_.js";import"./pencil-fd9eBnUr.js";import"./trash-2-BGsS4Tma.js";import"./alert-dialog-DBPQtoSw.js";import"./label-Dif50TA4.js";import"./input-error-B-ImtbXT.js";import"./checkbox-XYYM_-Ow.js";import"./color-picker-BeT-307a.js";import"./info-Bft2xYep.js";const $=[{title:"General Settings",href:route("settings.machine-status.index")},{title:"Ticket Statuses",href:route("settings.ticket-status.index"),isCurrent:!0}];function ae({statuses:l,machineStatuses:d,behaviors:f,filters:n}){const[O,m]=s.useState(!1),[T,p]=s.useState(!1),[c,h]=s.useState(null),[a,v]=s.useState(null),[x,M]=s.useState(n.search||""),[o,g]=s.useState(n.sort?{id:n.sort,desc:n.direction==="desc"}:null),[_,S]=s.useState(!1),j=s.useRef(!0),r=F({name:"",bg_color:"#dcfce7",text_color:"#166534",behaviors:[]}),I={create:u("tickets.edit"),edit:u("tickets.edit"),delete:u("tickets.edit")};s.useEffect(()=>{if(j.current){j.current=!1;return}const e=setTimeout(()=>{C.get(route("settings.ticket-status.index"),{search:x,sort:o==null?void 0:o.id,direction:o!=null&&o.desc?"desc":"asc"},{preserveState:!0,replace:!0})},300);return()=>clearTimeout(e)},[x,o]);const w=(e,i)=>{g(i===null?null:{id:e,desc:i==="desc"})},y=()=>{r.reset(),h(null),m(!0)},L=e=>{r.setData({name:e.name,bg_color:e.bg_color,text_color:e.text_color,behaviors:e.behaviors.map(i=>{var k;return{id:i.id,machine_status_id:((k=i.pivot)==null?void 0:k.machine_status_id)||null}})}),h(e),m(!0)},N=e=>{v(e),p(!0)},A=e=>{a&&C.delete(route("settings.ticket-status.destroy",a.id),{data:{new_status_id:e},onSuccess:()=>p(!1)})},E=e=>{e.preventDefault();const i=()=>m(!1);c&&"id"in c?r.put(route("settings.ticket-status.update",c.id),{onSuccess:i}):r.post(route("settings.ticket-status.store"),{onSuccess:i})},b=s.useMemo(()=>W(L,N,w,o,d),[o]),D=B({data:l.data,columns:b,getCoreRowModel:V()}),R=a?l.data.filter(e=>e.id!==a.id):[];return t.jsx(K,{breadcrumbs:$,children:t.jsxs(Q,{children:[t.jsx(P,{title:"Ticket Statuses"}),t.jsxs("div",{className:"space-y-4",children:[t.jsx("div",{className:"flex items-center justify-between",children:t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Ticket Statuses"}),t.jsx("p",{className:"text-muted-foreground",children:"Manage the statuses that can be assigned to tickets."}),t.jsxs("p",{className:"mt-1 text-sm text-muted-foreground",children:["Learn more about"," ",t.jsx("button",{onClick:()=>S(!0),className:"text-primary italic hover:underline",children:"behaviors"}),"."]})]})}),t.jsx(z,{onSearch:M,searchPlaceholder:"Filter by status name...",createAction:I.create?t.jsxs(J,{onClick:y,children:[t.jsx(Z,{className:"mr-2 h-4 w-4"}),"Add Status"]}):null,viewOptionsAction:t.jsx(q,{table:D})}),t.jsx(G,{table:D,columns:b}),t.jsx(H,{paginated:l})]}),t.jsx(Y,{isOpen:O,onOpenChange:m,onSubmit:E,status:c,machineStatuses:d,behaviors:f,data:r.data,setData:r.setData,errors:r.errors,processing:r.processing}),t.jsx(X,{isOpen:T,onOpenChange:p,onConfirm:A,statusToDelete:a,otherStatuses:R}),t.jsx(U,{isOpen:_,onOpenChange:S,behaviors:f})]})})}export{ae as default};
